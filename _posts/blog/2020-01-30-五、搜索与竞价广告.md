---
layout: post
title: 计算广告 五、搜索与竞价广告
categories: [计算广告]
description: 搜索与竞价广告
keywords: 计算广告, 搜索与竞价广告
---

# 1 搜索广告
搜索广告是比较典型的竞价广告产品，特点是广告主就某标的物（在搜索广告中就是“关键词”）的广告展示机会展开拍卖式的竞争，并根据竞争结果依次占据该广告展示的若干位置。

竞价广告与展示量合约广告的不同点：
* 竞价广告不保证量，广告主需要自行调整效果与量的关系。
* 竞价广告不存在价的约束，广告主可以随时调整出价。

## 1.1 搜索广告产品形态
搜索广告竞价的标的物是**竞价关键词（bid term）**，用户输入的查询通过与关键词相匹配来确定是否可以出发此条广告。搜索广告具有如下特点：
* eCPM远高于一般的展示广告。
* 搜索广告的受众定向标签，即是上下文的搜索查询。
* 搜索广告的展示形式和自然搜索结果很接近，是的它具有了原生广告的意味。
* 从搜索广告发展起来的竞价交易模式已经逐渐发展成为互联网广告最主流的交易模式

## 1.2 搜索广告产品新形势
* 超越文字链的创意。
* 弱相关广告形式。
* 原生化探索。

## 1.3 搜索广告产品策略
![搜索广告决策过程](http://qixingjun.tech/images/%E8%AE%A1%E7%AE%97%E5%B9%BF%E5%91%8A/5.1.3%E6%90%9C%E7%B4%A2%E5%B9%BF%E5%91%8A%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B%E7%A4%BA%E6%84%8F.png)
如图所示，搜索广告的整个决策过程可以分为**查询扩展、检索、排序、放置、定价**等几个阶段。
* **查询扩展**。查询扩展是搜索广告独有的策略，目的是给广告主自动的拓展相关的查询词，扩大采买流量。搜索引擎会提供一些将广告中的关键词匹配到更多相关查询的服务：
    * **精确匹配**。 不对广告主提供的关键词做任何形式的扩展，保证忠实按照广告主意图精准执行。比如：“英语培训”这个关键词，可能触发广告的有“英语培训、培训英语”两个查询。
    * **短语匹配**。当用户的查询完全包含广告主关键词以及关键词的同义词，就认为匹配成功。比如：“英语培训”这个关键词，可能触发广告的有“英语培训、英语培训暑期培训班、哪个英语培训机构好、英语的相关培训、英文培训”等。
    * **广泛匹配**。当用户的查询词与广告主的关键词高度相关时，即使广告主未提交这些查询词，也可能被匹配。比如：“英语培训”这个关键词，可能触发广告的有“外语学习班、四级证书”等查询。
    * **否定匹配**。明确指出哪些词不能被匹配。
* **广告检索和广告排序**是广告系统较为通用的核心流程。
* **广告放置（ad placement）**。当广告候选完成排序以后，需要分别确定北区和东区的广告条数，这个环节称为广告放置。其中，最关键的是进入北区的条件。要确定一条广告是否可以进入北区要考虑两个关键因素：
    1. 该广告相关性是否足够。
    2. 该广告的**千次展示收入（Revenue per Mille，RPM）**是否足够。
    
    前者是为了用户体验，后者是为了高效利用展示位置。
* **定价**是竞价广告核心策略。

# 2 位置拍卖与机制设计
![位置拍卖问题示例](http://qixingjun.tech/images/%E8%AE%A1%E7%AE%97%E5%B9%BF%E5%91%8A/5.2%20%E4%BD%8D%E7%BD%AE%E6%8B%8D%E5%8D%96%E9%97%AE%E9%A2%98%E7%A4%BA%E4%BE%8B.png)
如图所示，假设有一组广告位可以被占用将这些广告位按照其经验价值排名，分别记为s=1,2···,S。在某次广告请求中，有一组广告a=1,2,3···,A出价参与拍卖。每个广告的出价记为ba。系统将前S个高出价的广告依次放到前面排序好的S个广告位上，这样的问题称为**位置拍卖（position auction）**。如何设计位置拍卖问题中的一些重要机制称为**机制设计**。在广告中，常见的机制设计问题包括：定价、市场保留价、价格挤压等。

## 2.1 定价（Pricing）问题
在线广告竞价市场最常见的是GSP方案，其次是VCG方案。

### 2.1.1 广义第二高价（Generalized Second Price，GSP）方案
在学习广义第二高价之前，先来学习一下什么是**第二高价（Second Price，SP）**。所谓第二高价，指的是在只有一个位置的拍卖中，向赢得该位置的广告主收取其下一位广告主的出价。故对于多个位置的拍卖过程，对赢得每个位置的广告主，都按照他下一位的广告位置出价来收取费用，这就是**广义第二高价**。

### 2.1.2 VCG（Vickrey-Clarke-Groves）方案
VCG的基本思想是：对于赢得了某个位置的广告主，其所付出的成本应该等于他占据这个位置给其他市场参与者带来的价值损害。

## 2.2 市场保留价
为控制广告的质量和保持一定的出售单价，往往要设置一个赢得拍卖位置的最低价格，称为**市场保留价（Market Reserve Price，MRP），也称“起价”或“底价”**。广告主出价只有在高于MRP时，才有机会或者拍卖机会。

在竞争较为充分、广告主深度足够的时候，MRP可以设置的比较高；反之应该适当降低。

无论是调整市场整体的MRP，还是在不同流量划分上动态设置MRP，其基本原理都是根据竞价广告主的eCPM分布，找到一个使得填充率没有明显下降的CPM底价，然后再根据质量度倒数算其CPC底价。

## 2.3 价格挤压
在CPC结算中，**eCPM=μ\*bid<sub>cpc</sub>**，即点击率和出价的乘积。在竞价机制设计中，有时候会做些微调：**eCPM=μ<sup>k</sup>\*bid<sub>cpc</sub>，（k为大于0的实数）**。考虑两种极端情况：
* k趋向于正无穷的时候，相当于只根据点击率来排序而不考虑出价；
* k趋向于0的时候，相当于只根据出价来排序。

随着k的增大，相当于我们在挤压出价在整个竞价体系中的作用，因此将k称为**价格挤压（squashing）因子**。价格挤压因子的作用是**根据市场情况更加主动的影响竞价体系向着需要的方向发展**。

# 3 广告网络
对展示广告而言，合约式的售卖方式必然无法无法消耗所有的库存，实际销售中为了控制售卖比例以获得更高的品牌溢价空间，未通过合约售卖的广告流量很多，这部分流量称为**剩余流量（remnant inventory）**。

广告网络的产品功能是批量聚合各媒体的剩余流量，按照人群或者上下文标签的流量切割方式售卖给广告主。

## 3.1 广告网络产品形态
广告网络的投放决策过程对媒体而言是一个黑盒：只需要在广告位的剩余流量上调用广告网络的投放代码或者SDK，而不用关心每次展示的投放结果。

![广告网络广告示例](http://qixingjun.tech/images/%E8%AE%A1%E7%AE%97%E5%B9%BF%E5%91%8A/5.3.1%E5%B9%BF%E5%91%8A%E7%BD%91%E7%BB%9C%E5%B9%BF%E5%91%8A%E7%A4%BA%E4%BE%8B.png)
竞价广告网络的产品逻辑如图所示。竞价广告网络的产品特点：
* 售卖的标的物主要是人群，广告位被淡化。
* 简单的采用竞价模式而不用考虑量的合约，根据eCPM来决定每次展示分配给哪个广告主。
* 财务上采用广告主先充值的方式，使得广告网络运营方的现金流大大改善。

某些广告网络会对一部分合作提供方开放广告库供其自行挑选，这种运营模式称为**联盟（affiliate）模式**。

## 3.2 广告网络产品策略
![竞价广告网络广告决策过程示意](http://qixingjun.tech/images/%E8%AE%A1%E7%AE%97%E5%B9%BF%E5%91%8A/5.3.2%E7%AB%9E%E4%BB%B7%E5%B9%BF%E5%91%8A%E7%BD%91%E7%BB%9C%E5%B9%BF%E5%91%8A%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B%E7%A4%BA%E6%84%8F.png)
广告网络广告决策的流程相对简单一些，分为**检索、排序、定价**等几个阶段。

### 3.2.1 广告检索
广告与搜索面对的文档不同，它往往是一个用布尔表达式表达的投放条件，而不是可以简单看成一个词的集合。

搜索广告检索与搜索基本一致，用常规的[倒排索引](https://baike.baidu.com/item/%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95/11001569?fr=aladdin)技术就可以解决。展示广告网络与搜索广告不同，由于用户意图不明确，我们往往要将更多的关键字、兴趣标签同时用于检索过程。

### 3.2.2 广告排序
竞价广告中排序的准则是eCPM，而在CPC结算的情形下，对 eCPM 的估计转化为对点击率的估计问题。广告网络中的CTR预测有两方面的困难：
* 点击数据更加稀疏，而且需要同时考虑上下文和用户量方面的信息，这使得各种新广告、新策略的冷启动问题非常突出。
* 广告网络中由于广告位的差别巨大，点击率的变动范围很大，这使得稳健地估计点击率变得相对困难。

# 4 竞价广告需求方产品
竞价广告市场的产生对需求方提出了新的问题：
* 如何挑选合适的目标人群。
* 如何对各个目标人群给出合适的出价。

## 4.1 搜索引擎营销
搜索广告对应的需求方产品，即通过竞价采买搜索引擎关键词来做推广，这就是**搜索引擎营销（Search Engine Marketing，SEM）**。上面说的两个问题在SEM中具体表现为**关键词的选择**和**出价**。

## 4.2 媒体购买平台
面向展示广告网络的一站式采买平台称为**媒体采买平台**，与之类似的还有**交易终端（Trading Desk，TD）**。媒体采买平台的技术挑战主要在于**ROI的优化**。要合理的选择需要的受众定向条件，并在每个人群上优化出价，以保证量的要求和优化收益是一个复杂的组合优化问题。
